# ä»é›¶å¼€å§‹å­¦WEBå‰ç«¯ğŸ’¦â€”â€”JavaScriptå¼‚æ­¥è¯·æ±‚

## ğŸ““é¡¹ç›®ä»‹ç»

å…ˆåšä¸ªè‡ªæˆ‘ä»‹ç»ï¼Œæœ¬äººæ˜¯ä¸€ä¸ªæ²¡äººå†™å‰ç«¯æ‰€ä»¥å°±è‡ªå­¦å‰ç«¯çš„åç«¯ç¨‹åºå‘˜ğŸ™‡ã€‚åœ¨æ­¤é¡¹ç›®ä¸­æˆ‘ä¼šå’Œå¤§å®¶ä¸€èµ·ä»é›¶åŸºç¡€å¼€å§‹å­¦ä¹ å‰ç«¯ï¼Œä»åç«¯ç¨‹åºå‘˜çš„è§†è§’æ¥çœ‹å‰ç«¯ï¼Œå—é™äºä½œè€…çš„æ°´å¹³æœ¬é¡¹ç›®æš‚æ—¶åªä¼šæ›´æ–°åˆ°å‰ç«¯æ¡†æ¶VUEï¼Œä¸ä¼šæ¶‰åŠnode.jsã€‚è¯¥é¡¹ç›®é€‚åˆé›¶åŸºç¡€çš„å°ç™½æˆ–è€…å’Œæˆ‘ä¸€æ ·å¼€å‘ç½‘ç«™æ²¡äººå†™å‰ç«¯æ‰€ä»¥è‡ªå­¦å‰ç«¯çš„åç«¯ç¨‹åºå‘˜ğŸ˜‚ã€‚

è¯¥é¡¹ç›®çš„å­¦ä¹ é¡ºåºæ˜¯æŒ‰ç…§æˆ‘è‡ªå·±å­¦ä¹ æ—¶æ€»ç»“å‡ºæ¥çš„ï¼Œå…¶ä¸­çš„æ¯ä¸ªçŸ¥è¯†ç‚¹éƒ½æ˜¯æˆ‘è®¤çœŸå»ç†è§£çš„ï¼ŒåŒæ—¶ä¹ŸæŸ¥äº†å¾ˆå¤šçš„èµ„æ–™ï¼Œæ‰€æœ‰çš„å‚è€ƒèµ„æ–™æˆ‘éƒ½æ”¾åœ¨äº†æ–‡ç« æœ«å°¾ã€‚å°Šé‡å¼€æºï¼Œå°Šé‡çŸ¥è¯†äº§æƒã€‚æ¯ä¸€ä¸ªæ¡ˆä¾‹æˆ‘éƒ½äº²æ‰‹å†™è¿‡å¹¶è§‰å¾—ä¸é”™æ‰æ”¾ä¸Šå»çš„ã€‚æ¯æ¬¡çš„ä»£ç å’Œç¬”è®°æˆ‘éƒ½æ”¾åœ¨äº†å¼€æºä»“åº“é‡Œï¼Œæœ‰éœ€è¦çš„åŒå­¦è¯·ä¸è¦åå•¬ç»™æˆ‘ä¸€ä¸ªstarã€‚å¦‚æœè§‰å¾—æœ¬æ–‡å†™çš„ä¸é”™çš„è¯è®°å¾—ç‚¹èµ+å…³æ³¨ï¼Œä½ ä»¬çš„æ”¯æŒæ˜¯æˆ‘åšæŒä¸‹å»çš„åŠ¨åŠ›ğŸ˜ƒã€‚

> ç‹¬æ€œå¹½è‰æ¶§è¾¹ç”Ÿï¼Œä¸Šæœ‰é»„é¹‚æ·±æ ‘é¸£ã€‚
> æ˜¥æ½®å¸¦é›¨æ™šæ¥æ€¥ï¼Œé‡æ¸¡æ— äººèˆŸè‡ªæ¨ªã€‚
> 
> â€”â€”éŸ¦åº”ç‰©ã€Šæ»å·è¥¿æ¶§ã€‹

è¯­é›€åœ°å€ï¼š[https://www.yuque.com/beilayanmen](https://www.yuque.com/beilayanmen)

Githubåœ°å€ï¼š[https://github.com/SuZui-cn/my-web](https://github.com/SuZui-cn/my-web)

Giteeåœ°å€ï¼š[https://gitee.com/north_gate/my-web](https://gitee.com/north_gate/my-web)

ä¸ªäººåšå®¢åœ°å€ï¼š[https://foollyone.cn/](https://foollyone.cn/)

## âŒ¨æœ¬æ–‡çŸ¥è¯†ç‚¹

* AJAXä»‹ç»
* åŸç”ŸAJAX
  * åˆ›å»ºå¯¹è±¡
  * å‘èµ·è¯·æ±‚
  * æœåŠ¡å™¨å“åº”
* æ¡ˆä¾‹

<!--more-->

AJAX(å¼‚æ­¥è¯·æ±‚) ä½œä¸ºå’Œåç«¯äº¤äº’çš„ä¸»è¦æ–¹å¼ï¼Œè¿™ä¸ªæŠ€æœ¯ä¸€å®šè¦ç€é‡æŒæ¡ã€‚åœ¨æŒæ¡åŸç”ŸAJAXä¹‹åå­¦ä¹ å¼‚æ­¥è¯·æ±‚æ¡†æ¶ä¼šå˜å¾—éå¸¸çš„è½»æ¾ã€‚

## AJAXä»‹ç»

> AJAX = å¼‚æ­¥ JavaScript å’Œ XMLã€‚
>
> AJAX æ˜¯ä¸€ç§ç”¨äºåˆ›å»ºå¿«é€ŸåŠ¨æ€ç½‘é¡µçš„æŠ€æœ¯ã€‚
>
> é€šè¿‡åœ¨åå°ä¸æœåŠ¡å™¨è¿›è¡Œå°‘é‡æ•°æ®äº¤æ¢ï¼ŒAJAX å¯ä»¥ä½¿ç½‘é¡µå®ç°å¼‚æ­¥æ›´æ–°ã€‚è¿™æ„å‘³ç€å¯ä»¥åœ¨ä¸é‡æ–°åŠ è½½æ•´ä¸ªç½‘é¡µçš„æƒ…å†µä¸‹ï¼Œå¯¹ç½‘é¡µçš„æŸéƒ¨åˆ†è¿›è¡Œæ›´æ–°ã€‚
>
> ä¼ ç»Ÿçš„ç½‘é¡µï¼ˆä¸ä½¿ç”¨ AJAXï¼‰å¦‚æœéœ€è¦æ›´æ–°å†…å®¹ï¼Œå¿…éœ€é‡è½½æ•´ä¸ªç½‘é¡µé¢ã€‚
>
> æœ‰å¾ˆå¤šä½¿ç”¨ AJAX çš„åº”ç”¨ç¨‹åºæ¡ˆä¾‹ï¼šæ–°æµªå¾®åšã€Google åœ°å›¾ã€å¼€å¿ƒç½‘ç­‰ç­‰ã€‚
>
> â€”â€”èœé¸Ÿæ•™ç¨‹

> AJAX æ˜¯ä¸€ç§åœ¨æ— éœ€é‡æ–°åŠ è½½æ•´ä¸ªç½‘é¡µçš„æƒ…å†µä¸‹ï¼Œèƒ½å¤Ÿæ›´æ–°éƒ¨åˆ†ç½‘é¡µçš„æŠ€æœ¯ã€‚

## å·¥ä½œåŸç†

![image-20220310224058964](https://gitee.com/north_gate/drawing-bed/raw/master/images/image-20220310224058964.png)

## åŸç”ŸAJAX

åŸç”ŸAJAXçš„ä½¿ç”¨æ­¥éª¤åˆ†ä¸ºä¸€ä¸‹å‡ æ­¥ï¼š

* åˆ›å»ºå¯¹è±¡
* å‘èµ·è¯·æ±‚
* æœåŠ¡å™¨å“åº”
* onreadystatechange äº‹ä»¶

### åˆ›å»ºå¯¹è±¡

XMLHttpRequest æ˜¯ AJAX çš„åŸºç¡€ã€‚

æ‰€æœ‰ç°ä»£æµè§ˆå™¨å‡æ”¯æŒ XMLHttpRequest å¯¹è±¡ï¼ˆIE5 å’Œ IE6 ä½¿ç”¨ ActiveXObjectï¼‰ã€‚

XMLHttpRequest ç”¨äºåœ¨åå°ä¸æœåŠ¡å™¨äº¤æ¢æ•°æ®ã€‚è¿™æ„å‘³ç€å¯ä»¥åœ¨ä¸é‡æ–°åŠ è½½æ•´ä¸ªç½‘é¡µçš„æƒ…å†µä¸‹ï¼Œå¯¹ç½‘é¡µçš„æŸéƒ¨åˆ†è¿›è¡Œæ›´æ–°ã€‚

```javascript
var xmlhttp;
if (window.XMLHttpRequest)
{
    //  IE7+, Firefox, Chrome, Opera, Safari æµè§ˆå™¨æ‰§è¡Œä»£ç 
    xmlhttp=new XMLHttpRequest();
}
else
{
    // IE6, IE5 æµè§ˆå™¨æ‰§è¡Œä»£ç 
    xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
}
```

### å‘èµ·è¯·æ±‚

å¦‚éœ€å°†è¯·æ±‚å‘é€åˆ°æœåŠ¡å™¨ï¼Œæˆ‘ä»¬ä½¿ç”¨ **XMLHttpRequest** å¯¹è±¡çš„ **open()** å’Œ **send()** æ–¹æ³•ï¼š

```
xmlhttp.open("GET","ajax_info.txt",true);
xmlhttp.send();
```

![image-20220310230314612](https://gitee.com/north_gate/drawing-bed/raw/master/images/image-20220310230314612.png)

ä»¥ä¸‹æƒ…å†µä½¿ç”¨POSTï¼š

*  ä¸æ„¿ä½¿ç”¨ç¼“å­˜æ–‡ä»¶ï¼ˆæ›´æ–°æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶æˆ–æ•°æ®åº“ï¼‰
* å‘æœåŠ¡å™¨å‘é€å¤§é‡æ•°æ®ï¼ˆPOST æ²¡æœ‰æ•°æ®é‡é™åˆ¶ï¼‰
* å‘é€åŒ…å«æœªçŸ¥å­—ç¬¦çš„ç”¨æˆ·è¾“å…¥æ—¶ï¼ŒPOST æ¯” GET æ›´ç¨³å®šä¹Ÿæ›´å¯é 

### æœåŠ¡å™¨å“åº”

å¦‚éœ€è·å¾—æ¥è‡ªæœåŠ¡å™¨çš„å“åº”ï¼Œè¯·ä½¿ç”¨ XMLHttpRequest å¯¹è±¡çš„ responseText æˆ– responseXML å±æ€§ã€‚

å¦‚æœæ¥è‡ªæœåŠ¡å™¨çš„å“åº”å¹¶é XMLï¼Œè¯·ä½¿ç”¨ responseText å±æ€§ã€‚

### onreadystatechange äº‹ä»¶

å½“è¯·æ±‚è¢«å‘é€åˆ°æœåŠ¡å™¨æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ‰§è¡Œä¸€äº›åŸºäºå“åº”çš„ä»»åŠ¡ã€‚

æ¯å½“ readyState æ”¹å˜æ—¶ï¼Œå°±ä¼šè§¦å‘ onreadystatechange äº‹ä»¶ã€‚

readyState å±æ€§å­˜æœ‰ XMLHttpRequest çš„çŠ¶æ€ä¿¡æ¯ã€‚

ä¸‹é¢æ˜¯ XMLHttpRequest å¯¹è±¡çš„ä¸‰ä¸ªé‡è¦çš„å±æ€§ï¼š

![image-20220310230539436](https://gitee.com/north_gate/drawing-bed/raw/master/images/image-20220310230539436.png)

åœ¨ onreadystatechange äº‹ä»¶ä¸­ï¼Œæˆ‘ä»¬è§„å®šå½“æœåŠ¡å™¨å“åº”å·²åšå¥½è¢«å¤„ç†çš„å‡†å¤‡æ—¶æ‰€æ‰§è¡Œçš„ä»»åŠ¡ã€‚

å½“ readyState ç­‰äº 4 ä¸”çŠ¶æ€ä¸º 200 æ—¶ï¼Œè¡¨ç¤ºå“åº”å·²å°±ç»ªï¼š

## æ¡ˆä¾‹

åœ¨å®é™…çš„å¼€å‘ä¸­url åº”è¯¥ä¸ºåç«¯æ¥å£çš„åœ°å€ï¼Œè¿™é‡Œä¸ºäº†æ–¹ä¾¿æµ‹è¯•ï¼Œæ‰€ä»¥é‡‡å–è¯»å–æœ¬åœ°æ–‡ä»¶çš„æ–¹å¼ã€‚ä½†æ˜¯ç”±äºè°·æ­Œçš„å®‰å…¨ç­–ç•¥ï¼ŒAJAXæ— æ³•è®¿é—®æœ¬åœ°æ–‡ä»¶ã€‚æ‰€ä»¥å¯ä»¥ç›´æ¥çœ‹èœé¸Ÿæ•™ç¨‹çš„æ¡ˆä¾‹ã€‚

åœ°å€ï¼š[https://www.runoob.com/try/try.php?filename=tryajax_first](https://www.runoob.com/try/try.php?filename=tryajax_first)

```html
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <script>
      function loadXMLDoc() {
        var xmlhttp;
        if (window.XMLHttpRequest) {
          //  IE7+, Firefox, Chrome, Opera, Safari æµè§ˆå™¨æ‰§è¡Œä»£ç 
          xmlhttp = new XMLHttpRequest();
        } else {
          // IE6, IE5 æµè§ˆå™¨æ‰§è¡Œä»£ç 
          xmlhttp = new ActiveXObject('Microsoft.XMLHTTP');
        }
        xmlhttp.onreadystatechange = function () {
          if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
            document.getElementById('myDiv').innerHTML = xmlhttp.responseText;
          }
        };
        xmlhttp.open('GET', './æµ‹è¯•.txt', true);
        xmlhttp.send();
      }
    </script>
  </head>
  <body>
    <div id="myDiv"><h2>ä½¿ç”¨ AJAX ä¿®æ”¹è¯¥æ–‡æœ¬å†…å®¹</h2></div>
    <button type="button" onclick="loadXMLDoc()">ä¿®æ”¹å†…å®¹</button>
  </body>
</html>
```

### å‘é€getè¯·æ±‚

```javascript
<input name="submit" type="button" id="submit" value="å‘æœåŠ¡å™¨å‘å‡ºè¯·æ±‚" />
<script>
    window.onload = function () {  //é¡µé¢åˆå§‹åŒ–
        var b = document.getElementsByTagName("input")[0];
        b.onclick = function () {
            var url = "url?callback=functionName"ï¼›  //è®¾ç½®æŸ¥è¯¢å­—ç¬¦ä¸²
            var xhr = createXHR();  //å®ä¾‹åŒ–XMLHttpRequest å¯¹è±¡
            xhr.open("GET", url, false);  //å»ºç«‹è¿æ¥ï¼Œè¦æ±‚åŒæ­¥å“åº”
            xhr.send(null);  //å‘é€è¯·æ±‚
            console.log(xhr.responseText);  //æ¥æ”¶æ•°æ®
        }
    }
</script>
```

### å‘é€postè¯·æ±‚

```javascript
window.onload = function () {  //é¡µé¢åˆå§‹åŒ–
    var b = document.getElementsByTagName("input")[0];
    b.onclick = function () {
        var url = "url";  //è®¾ç½®è¯·æ±‚çš„åœ°å€
        var xhr = createXHR();  //å®ä¾‹åŒ–XMLHttpRequest å¯¹è±¡
        xhr.open("POST", url, false);  //å»ºç«‹è¿æ¥ï¼Œè¦æ±‚åŒæ­¥å“åº”
        xhr.setRequestHeader ('Content-type', 'application/x-www-form-urlencoded');  //è®¾ç½®ä¸ºè¡¨å•æ–¹å¼æäº¤
        xhr.send("callback=functionName");  //å‘é€è¯·æ±‚
        console.log(xhr.responseText);  //æ¥æ”¶æ•°æ®
    }
}
```

