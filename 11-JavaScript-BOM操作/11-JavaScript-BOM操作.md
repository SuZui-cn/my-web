# ä»é›¶å¼€å§‹å­¦WEBå‰ç«¯ğŸ’¦â€”â€”JavaScript-BOMæ“ä½œ

## ğŸ““é¡¹ç›®ä»‹ç»

å…ˆåšä¸ªè‡ªæˆ‘ä»‹ç»ï¼Œæœ¬äººæ˜¯ä¸€ä¸ªæ²¡äººå†™å‰ç«¯æ‰€ä»¥å°±è‡ªå­¦å‰ç«¯çš„åç«¯ç¨‹åºå‘˜ğŸ™‡ã€‚åœ¨æ­¤é¡¹ç›®ä¸­æˆ‘ä¼šå’Œå¤§å®¶ä¸€èµ·ä»é›¶åŸºç¡€å¼€å§‹å­¦ä¹ å‰ç«¯ï¼Œä»åç«¯ç¨‹åºå‘˜çš„è§†è§’æ¥çœ‹å‰ç«¯ï¼Œå—é™äºä½œè€…çš„æ°´å¹³æœ¬é¡¹ç›®æš‚æ—¶åªä¼šæ›´æ–°åˆ°å‰ç«¯æ¡†æ¶VUEï¼Œä¸ä¼šæ¶‰åŠnode.jsã€‚è¯¥é¡¹ç›®é€‚åˆé›¶åŸºç¡€çš„å°ç™½æˆ–è€…å’Œæˆ‘ä¸€æ ·å¼€å‘ç½‘ç«™æ²¡äººå†™å‰ç«¯æ‰€ä»¥è‡ªå­¦å‰ç«¯çš„åç«¯ç¨‹åºå‘˜ğŸ˜‚ã€‚

è¯¥é¡¹ç›®çš„å­¦ä¹ é¡ºåºæ˜¯æŒ‰ç…§æˆ‘è‡ªå·±å­¦ä¹ æ—¶æ€»ç»“å‡ºæ¥çš„ï¼Œå…¶ä¸­çš„æ¯ä¸ªçŸ¥è¯†ç‚¹éƒ½æ˜¯æˆ‘è®¤çœŸå»ç†è§£çš„ï¼ŒåŒæ—¶ä¹ŸæŸ¥äº†å¾ˆå¤šçš„èµ„æ–™ï¼Œæ‰€æœ‰çš„å‚è€ƒèµ„æ–™æˆ‘éƒ½æ”¾åœ¨äº†æ–‡ç« æœ«å°¾ã€‚å°Šé‡å¼€æºï¼Œå°Šé‡çŸ¥è¯†äº§æƒã€‚æ¯ä¸€ä¸ªæ¡ˆä¾‹æˆ‘éƒ½äº²æ‰‹å†™è¿‡å¹¶è§‰å¾—ä¸é”™æ‰æ”¾ä¸Šå»çš„ã€‚æ¯æ¬¡çš„ä»£ç å’Œç¬”è®°æˆ‘éƒ½æ”¾åœ¨äº†å¼€æºä»“åº“é‡Œï¼Œæœ‰éœ€è¦çš„åŒå­¦è¯·ä¸è¦åå•¬ç»™æˆ‘ä¸€ä¸ªstarã€‚å¦‚æœè§‰å¾—æœ¬æ–‡å†™çš„ä¸é”™çš„è¯è®°å¾—ç‚¹èµ+å…³æ³¨ï¼Œä½ ä»¬çš„æ”¯æŒæ˜¯æˆ‘åšæŒä¸‹å»çš„åŠ¨åŠ›ğŸ˜ƒã€‚

> æŠ˜æˆŸæ²‰æ²™é“æœªé”€ï¼Œè‡ªå°†ç£¨æ´—è®¤å‰æœã€‚
>
> ä¸œé£ä¸ä¸å‘¨éƒä¾¿ï¼Œé“œé›€æ˜¥æ·±é”äºŒä¹”ã€‚
>
> â€”â€”æœç‰§ã€Šèµ¤å£ã€‹

è¯­é›€åœ°å€ï¼š[https://www.yuque.com/beilayanmen](https://www.yuque.com/beilayanmen)

Githubåœ°å€ï¼š[https://github.com/SuZui-cn/my-web](https://github.com/SuZui-cn/my-web)

Giteeåœ°å€ï¼š[https://gitee.com/north_gate/my-web](https://gitee.com/north_gate/my-web)

ä¸ªäººåšå®¢åœ°å€ï¼š[https://foollyone.cn/](https://foollyone.cn/)

## âŒ¨æœ¬æ–‡çŸ¥è¯†ç‚¹

* windowå¯¹è±¡
  * å…¨å±€ä½œç”¨åŸŸ
  * å¸¸è§äº‹ä»¶
  * è°ƒèŠ‚çª—å£å¤§å°
  * å®šæ—¶å™¨setTimeout
  * thisæŒ‡å‘é—®é¢˜
* locationå¯¹è±¡
  * è·³è½¬é¡µé¢
  * locationå¸¸è§æ–¹æ³•
* å°ç»“

<!--more-->

> ECMAScriptæ˜¯JavaScriptçš„æ ¸å¿ƒï¼Œä½†å¦‚æœè¦åœ¨Webä¸­ä½¿ç”¨JavaScriptï¼Œé‚£ä¹ˆBOMï¼ˆæµè§ˆå™¨å¯¹è±¡æ¨¡å‹ï¼‰åˆ™æ— ç–‘æ‰æ˜¯çœŸæ­£çš„æ ¸å¿ƒã€‚BOMæä¾›äº†å¾ˆå¤šå¯¹è±¡ï¼Œç”¨äºè®¿é—®æµè§ˆå™¨çš„åŠŸèƒ½ï¼Œè¿™äº›åŠŸèƒ½ä¸ä»»ä½•ç½‘é¡µå†…å®¹æ— å…³ã€‚
>
> â€”â€”Nicholas C.Zakasã€ŠJavaScripté«˜çº§ç¨‹åºè®¾è®¡ï¼ˆç¬¬ä¸‰ç‰ˆï¼‰ã€‹

## windowå¯¹è±¡

BOMçš„æ ¸å¿ƒå¯¹è±¡æ˜¯windowï¼Œå®ƒè¡¨ç¤ºæµè§ˆå™¨çš„ä¸€ä¸ªå®ä¾‹ã€‚åœ¨æµè§ˆå™¨ä¸­ï¼Œwindowå¯¹è±¡æœ‰åŒé‡è§’è‰²ï¼Œå®ƒæ—¢æ˜¯é€šè¿‡JavaScriptè®¿é—®æµè§ˆå™¨çª—å£çš„ä¸€ä¸ªæ¥å£ï¼Œåˆæ˜¯ECMAScriptè§„å®šçš„Globalå¯¹è±¡ã€‚è¿™æ„å‘³ç€åœ¨ç½‘é¡µä¸­å®šä¹‰çš„ä»»ä½•ä¸€ä¸ªå¯¹è±¡ã€å˜é‡å’Œå‡½æ•°ï¼Œéƒ½ä»¥windowä½œä¸ºå…¶Globalå¯¹è±¡ï¼Œå› æ­¤æœ‰æƒè®¿é—®parseInt()ç­‰æ–¹æ³•ã€‚

### å…¨å±€ä½œç”¨åŸŸ

ç”±äºwindowå¯¹è±¡åŒæ—¶æ‰®æ¼”ç€ECMAScriptä¸­Globalå¯¹è±¡çš„è§’è‰²ï¼Œå› æ­¤æ‰€æœ‰åœ¨å…¨å±€ä½œç”¨åŸŸä¸­å£°æ˜çš„å˜é‡ã€å‡½æ•°éƒ½ä¼šå˜æˆwindowå¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ã€‚æ¥çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚

![image-20220310215154178](https://gitee.com/north_gate/drawing-bed/raw/master/images/image-20220310215154178.png)

æˆ‘ä»¬åœ¨å…¨å±€ä½œç”¨åŸŸä¸­å®šä¹‰äº†ä¸€ä¸ªå˜é‡nameå’Œä¸€ä¸ªå‡½æ•°sayName()ï¼Œå®ƒä»¬è¢«è‡ªåŠ¨å½’åœ¨äº†windowå¯¹è±¡åä¸‹ã€‚äºæ˜¯ï¼Œå¯ä»¥é€šè¿‡window.nameè®¿é—®å˜é‡nameï¼Œå¯ä»¥é€šè¿‡window.sayAge()è®¿é—®å‡½æ•°sayName()ã€‚ç”±äºsayName()å­˜åœ¨äºå…¨å±€ä½œç”¨åŸŸä¸­ï¼Œå› æ­¤this.nameè¢«æ˜ å°„åˆ°window.nameï¼Œæœ€ç»ˆæ˜¾ç¤ºçš„ä»ç„¶æ˜¯æ­£ç¡®çš„ç»“æœã€‚

### å¸¸è§äº‹ä»¶

windowå¯¹è±¡ä¹Ÿæœ‰ä¸€äº›è‡ªå·±çš„äº‹ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
    <script>
      window.addEventListener('load', function () {
        var btn = document.querySelector('button');
        btn.addEventListener('click', function () {
          alert('ç‚¹å‡»æˆ‘');
        });
      });
      window.addEventListener('load', function () {
        alert(22);
      });
      document.addEventListener('DOMContentLoaded', function () {
        alert(33);
      });
      // load ç­‰é¡µé¢å†…å®¹å…¨éƒ¨åŠ è½½å®Œæ¯•ï¼ŒåŒ…å«é¡µé¢domå…ƒç´  å›¾ç‰‡ flash  css ç­‰ç­‰
      // DOMContentLoaded æ˜¯DOM åŠ è½½å®Œæ¯•ï¼Œä¸åŒ…å«å›¾ç‰‡ falsh css ç­‰å°±å¯ä»¥æ‰§è¡Œ åŠ è½½é€Ÿåº¦æ¯” loadæ›´å¿«ä¸€äº›
    </script>
  </head>

  <body>
    <button>ç‚¹å‡»</button>
  </body>
</html>
```

### è°ƒèŠ‚çª—å£å¤§å°

æ¯”å¦‚ä¸‹é¢è¿™ä¸ªæ¡ˆä¾‹ï¼Œå½“æˆ‘ä»¬æŠŠç½‘é¡µç¼©æ”¾åˆ°800çš„æ—¶å€™ç›’å­å°±ä¼šæ¶ˆå¤±ä¸è§ã€‚

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
    <style>
      div {
        width: 200px;
        height: 200px;
        background-color: pink;
      }
    </style>
  </head>

  <body>
    <script>
      window.addEventListener('load', function () {
        var div = document.querySelector('div');
        window.addEventListener('resize', function () {
          console.log(window.innerWidth);
          console.log('å˜åŒ–äº†');
          if (window.innerWidth <= 800) {
            div.style.display = 'none';
          } else {
            div.style.display = 'block';
          }
        });
      });
    </script>
    <div></div>
  </body>
</html>
```

### å®šæ—¶å™¨setTimeout

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
  </head>

  <body>
    <script>
      // 1. setTimeout
      // è¯­æ³•è§„èŒƒï¼š  window.setTimeout(è°ƒç”¨å‡½æ•°, å»¶æ—¶æ—¶é—´);
      // 1. è¿™ä¸ªwindowåœ¨è°ƒç”¨çš„æ—¶å€™å¯ä»¥çœç•¥
      // 2. è¿™ä¸ªå»¶æ—¶æ—¶é—´å•ä½æ˜¯æ¯«ç§’ ä½†æ˜¯å¯ä»¥çœç•¥ï¼Œå¦‚æœçœç•¥é»˜è®¤çš„æ˜¯0
      // 3. è¿™ä¸ªè°ƒç”¨å‡½æ•°å¯ä»¥ç›´æ¥å†™å‡½æ•° è¿˜å¯ä»¥å†™ å‡½æ•°å è¿˜æœ‰ä¸€ä¸ªå†™æ³• 'å‡½æ•°å()'
      // 4. é¡µé¢ä¸­å¯èƒ½æœ‰å¾ˆå¤šçš„å®šæ—¶å™¨ï¼Œæˆ‘ä»¬ç»å¸¸ç»™å®šæ—¶å™¨åŠ æ ‡è¯†ç¬¦ ï¼ˆåå­—)
      // setTimeout(function() {
      //     console.log('æ—¶é—´åˆ°äº†');

      // }, 2000);
      function callback() {
        console.log('æ‰§è¡ŒåŠ›');
      }
      var timer1 = setTimeout(callback, 3000);
      var timer2 = setTimeout(callback, 5000);
      // setTimeout('callback()', 3000); // æˆ‘ä»¬ä¸æå€¡è¿™ä¸ªå†™æ³•
    </script>
  </body>
</html>

```

### thisæŒ‡å‘é—®é¢˜

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
  </head>

  <body>
    <button>ç‚¹å‡»</button>
    <script>
      // this æŒ‡å‘é—®é¢˜ ä¸€èˆ¬æƒ…å†µä¸‹thisçš„æœ€ç»ˆæŒ‡å‘çš„æ˜¯é‚£ä¸ªè°ƒç”¨å®ƒçš„å¯¹è±¡

      // 1. å…¨å±€ä½œç”¨åŸŸæˆ–è€…æ™®é€šå‡½æ•°ä¸­thisæŒ‡å‘å…¨å±€å¯¹è±¡windowï¼ˆ æ³¨æ„å®šæ—¶å™¨é‡Œé¢çš„thisæŒ‡å‘windowï¼‰
      console.log(this);

      function fn() {
        console.log(this);
      }
      window.fn();
      window.setTimeout(function () {
        console.log(this);
      }, 1000);
      // 2. æ–¹æ³•è°ƒç”¨ä¸­è°è°ƒç”¨thisæŒ‡å‘è°
      var o = {
        sayHi: function () {
          console.log(this); // thisæŒ‡å‘çš„æ˜¯ o è¿™ä¸ªå¯¹è±¡
        },
      };
      o.sayHi();
      var btn = document.querySelector('button');
      // btn.onclick = function() {
      //     console.log(this); // thisæŒ‡å‘çš„æ˜¯btnè¿™ä¸ªæŒ‰é’®å¯¹è±¡

      // }
      btn.addEventListener('click', function () {
        console.log(this); // thisæŒ‡å‘çš„æ˜¯btnè¿™ä¸ªæŒ‰é’®å¯¹è±¡
      });
      // 3. æ„é€ å‡½æ•°ä¸­thisæŒ‡å‘æ„é€ å‡½æ•°çš„å®ä¾‹
      function Fun() {
        console.log(this); // this æŒ‡å‘çš„æ˜¯fun å®ä¾‹å¯¹è±¡
      }
      var fun = new Fun();
    </script>
  </body>
</html>
```

## locationå¯¹è±¡

### è½¬è·³é¡µé¢

```html
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>
    <button>ç‚¹å‡»</button>
    <div></div>
    <script>
        var btn = document.querySelector('button');
        var div = document.querySelector('div');
        btn.addEventListener('click', function() {
            // console.log(location.href);
            location.href = 'http://www.itcast.cn';
        })
        var timer = 5;
        setInterval(function() {
            if (timer == 0) {
                location.href = 'http://www.itcast.cn';
            } else {
                div.innerHTML = 'æ‚¨å°†åœ¨' + timer + 'ç§’é’Ÿä¹‹åè·³è½¬åˆ°é¦–é¡µ';
                timer--;
            }

        }, 1000);
    </script>
</body>
</html>
```

### locationå¸¸è§æ–¹æ³•

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
  </head>

  <body>
    <button>ç‚¹å‡»</button>
    <script>
      var btn = document.querySelector('button');
      btn.addEventListener('click', function () {
        // è®°å½•æµè§ˆå†å²ï¼Œæ‰€ä»¥å¯ä»¥å®ç°åé€€åŠŸèƒ½
        // location.assign('http://www.itcast.cn');
        // ä¸è®°å½•æµè§ˆå†å²ï¼Œæ‰€ä»¥ä¸å¯ä»¥å®ç°åé€€åŠŸèƒ½
        // location.replace('http://www.itcast.cn');
        location.reload(true);
      });
    </script>
  </body>
</html>
```

## å°ç»“

æµè§ˆå™¨å¯¹è±¡æ¨¡å‹ï¼ˆBOMï¼‰ä»¥windowå¯¹è±¡ä¸ºä¾æ‰˜ï¼Œè¡¨ç¤ºæµè§ˆå™¨çª—å£ä»¥åŠé¡µé¢å¯è§åŒºåŸŸã€‚åŒæ—¶ï¼Œwindowå¯¹è±¡è¿˜æ˜¯ECMAScriptä¸­çš„Globalå¯¹è±¡ï¼Œå› è€Œæ‰€æœ‰å…¨å±€å˜é‡å’Œå‡½æ•°éƒ½æ˜¯å®ƒçš„å±æ€§ï¼Œä¸”æ‰€æœ‰åŸç”Ÿçš„æ„é€ å‡½æ•°åŠå…¶ä»–å‡½æ•°ä¹Ÿéƒ½å­˜åœ¨äºå®ƒçš„å‘½åç©ºé—´ä¸‹ã€‚

* â åœ¨ä½¿ç”¨æ¡†æ¶æ—¶ï¼Œæ¯ä¸ªæ¡†æ¶éƒ½æœ‰è‡ªå·±çš„windowå¯¹è±¡ä»¥åŠæ‰€æœ‰åŸç”Ÿæ„é€ å‡½æ•°åŠå…¶ä»–å‡½æ•°çš„å‰¯æœ¬ã€‚æ¯ä¸ªæ¡†æ¶éƒ½ä¿å­˜åœ¨framesé›†åˆä¸­ï¼Œå¯ä»¥é€šè¿‡ä½ç½®æˆ–é€šè¿‡åç§°æ¥è®¿é—®ã€‚
* â æœ‰ä¸€äº›çª—å£æŒ‡é’ˆï¼Œå¯ä»¥ç”¨æ¥å¼•ç”¨å…¶ä»–æ¡†æ¶ï¼ŒåŒ…æ‹¬çˆ¶æ¡†æ¶ã€‚
* â topå¯¹è±¡å§‹ç»ˆæŒ‡å‘æœ€å¤–å›´çš„æ¡†æ¶ï¼Œä¹Ÿå°±æ˜¯æ•´ä¸ªæµè§ˆå™¨çª—å£ã€‚
* â parentå¯¹è±¡è¡¨ç¤ºåŒ…å«å½“å‰æ¡†æ¶çš„æ¡†æ¶ï¼Œè€Œselfå¯¹è±¡åˆ™å›æŒ‡windowã€‚
* â ä½¿ç”¨locationå¯¹è±¡å¯ä»¥é€šè¿‡ç¼–ç¨‹æ–¹å¼æ¥è®¿é—®æµè§ˆå™¨çš„å¯¼èˆªç³»ç»Ÿã€‚è®¾ç½®ç›¸åº”çš„å±æ€§ï¼Œå¯ä»¥é€æ®µæˆ–æ•´ä½“æ€§åœ°ä¿®æ”¹æµè§ˆå™¨çš„URLã€‚
* â è°ƒç”¨replace()æ–¹æ³•å¯ä»¥å¯¼èˆªåˆ°ä¸€ä¸ªæ–°URLï¼ŒåŒæ—¶è¯¥URLä¼šæ›¿æ¢æµè§ˆå™¨å†å²è®°å½•ä¸­å½“å‰æ˜¾ç¤ºçš„é¡µé¢ã€‚
* â navigatorå¯¹è±¡æä¾›äº†ä¸æµè§ˆå™¨æœ‰å…³çš„ä¿¡æ¯ã€‚åˆ°åº•æä¾›å“ªäº›ä¿¡æ¯ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºç”¨æˆ·çš„æµè§ˆå™¨ï¼›ä¸è¿‡ï¼Œä¹Ÿæœ‰ä¸€äº›å…¬å…±çš„å±æ€§ï¼ˆå¦‚userAgentï¼‰å­˜åœ¨äºæ‰€æœ‰æµè§ˆå™¨ä¸­ã€‚